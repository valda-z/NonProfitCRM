@model NonProfitCRM.Models.Group
@{
    List<string> allRoles = new List<string>();
    if (Model.Id == 0)
    {
        ViewBag.PreTitle = "new";
    }
    else
    {
        ViewBag.PreTitle = "detail of";
    }
    ViewBag.Title = "Group";
    ViewBag.PathTitle = "list of Groups >";
}

<section class="widget">
    <header></header>
    <div class="widget-body">
        @using (Html.BeginForm(null, null, new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post,
            new
            {
                @class = "form-horizontal",
                @data_parsley_priority_enabled = "false",
                @novalidate = "novalidate",
                @id = "validation-form"
            }))
        {
            @Html.HiddenFor(m => m.Id)
            <fieldset>
                <legend>Group details for <span class="fw-semi-bold">@Model @Model.Name</span></legend>
                @Html.Partial("_ValidationSummary", ViewData.ModelState)
                <div class="form-group">
                    @Html.LabelFor(m => m.Name, "Group Name", new { @class = "col-sm-3 control-label" })
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.Name, new { @class = "form-control", @required = "required" })
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-3 control-label">
                        Roles
                    </div>
                    <div class="col-sm-9">
                        @{
            string roleCh = "";
            foreach (string r in Roles.GetAllRoles())
            {
                allRoles.Add("checkbox-ios1-role_" + r);
                if (Model.Roles != null && Model.Roles.Contains(r + ";"))
                {
                    roleCh = "checked=\"checked\"";
                }
                else
                {
                    roleCh = "";
                }
                <div>
                    <div class="checkbox-inline checkbox-ios checkbox-ios-notready">
                        <label for="checkbox-ios1-role_@r">
                            <input value="@r" type="checkbox" id="checkbox-ios1-role_@r" name="role_@r" @roleCh>
                        </label>
                    </div>
                    &nbsp; @r
                </div>
            }
                        }
                    </div>
                </div>
            </fieldset>
            <div class="btn-toolbar">
                <a href="@ViewBag.ReturnUrl" class="btn btn btn-default pull-right">Cancel</a>
                <button type="submit" name="save" class="btn btn btn-primary pull-right">Save changes</button>
            </div>
        }
    </div>
</section>
@Scripts.Render("~/Content/sing/vendor/form-js")
@Html.Partial("_ParsleyLoader", "validation-form")

@{var _switchery = new System.Text.StringBuilder();
    foreach (var r in allRoles)
    {
        _switchery.AppendLine("new Switchery(document.getElementById('" + r + "'), { color: Sing.colors['brand-success'], size: 'small' });");
    }
}
<script>
    $(document).ready(function () {
        @Html.Raw(_switchery)
        $('.checkbox-ios-notready').each(function (i, elem) { $(elem).removeClass('checkbox-ios-notready') });
    });
</script>
